{% extends "base.html" %}

{% block title %}{{ tool.title }} - The Derivative Desk{% endblock %}

{% block styles %}
<link rel="stylesheet" href="/static/css/tool.css">
{% endblock %}

{% block content %}
<header class="tool-header">
    <h1>{{ tool.title }}</h1>
    <p>{{ tool.description }}</p>
</header>
<main>
    <!-- Note Section -->
    {% if tool.note %}
    <section class="note-section">
        <h3>Additional Information</h3>
        <p>{{ tool.note }}</p>
    </section>
    {% endif %}
    
    <!-- Input Section -->
    <section class="input-section">
        <h2>Inputs</h2>
        <form id="tool-form" enctype="multipart/form-data">
            <!-- Classic Inputs -->
            {% for input in tool.inputs %}
                {% if input.type != "select" and input.type != "file" %}
                <label for="{{ input.id }}">
                    {{ input.label }}
                    {% if not input.optional %}
                        <span class="required">*</span>
                    {% endif %}
                </label>
                <input 
                    type="{{ input.type }}" 
                    id="{{ input.id }}" 
                    name="{{ input.id }}" 
                    placeholder="{{ input.placeholder }}" 
                    {% if input.step %} step="{{ input.step }}" {% endif %} 
                    {% if not input.optional %} required {% endif %} 
                >
                {% endif %}
            {% endfor %}

            <!-- Dropdown Section -->
            {% for input in tool.inputs %}
                {% if input.type == "select" %}
                <div class="dropdown-section">
                    <label for="{{ input.id }}">{{ input.label }}</label>
                    <select id="{{ input.id }}" name="{{ input.id }}">
                        {% for option in input.options %}
                        <option value="{{ option }}" {% if input.default == option %}selected{% endif %}>
                            {{ option }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                {% endif %}
            {% endfor %}
            
            <!-- File Input for CSV -->
            {% for input in tool.inputs %}
                {% if input.type == "file" %}
                <label for="{{ input.id }}">
                    {{ input.label }}
                    <span class="optional">(Optional - replaces {{ input.data_target }})</span>
                </label>
                <input 
                    type="file" 
                    id="{{ input.id }}" 
                    name="{{ input.id }}" 
                    accept=".csv"
                    data_target="{{ input.target }}"
                >
                {% endif %}
            {% endfor %}

            <button type="submit" class="btn-submit">Calculate</button>
        </form>
    </section>
    
    <!-- Results Section -->
    <section class="results-section">
        <h2>Results</h2>
        <div id="results">
            {% for output in tool.outputs %}
                <p>{{ output }}: <span id="result-{{ loop.index }}">N/A</span></p>
            {% endfor %}
        </div>
    </section>

    <!-- Visualization Section (Optional) -->
    {% if tool.visualization %}
        <section class="visualization-section">
            <h2>Visualization</h2>
            <div id="visualization-container">
                <canvas id="chart"></canvas>
            </div>
        </section>
    {% endif %}
</main>
{% endblock %}

{% block scripts %}
<script src="/static/js/tool.js"></script>
{% endblock %}
